<!DOCTYPE html><html><head><title>Design Patterns: The Command Pattern</title><link href="/stylesheets/all-bd81847b.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all-d0af4672.js" type="text/javascript"></script><meta content='NO-CACHE' http-equiv='CACHE-CONTROL'><meta content='DockYard is a Ruby on Rails, PostgreSQL, and, Ember.js, web / mobile application development software consultancy based in Boston, MA.' namer='description'><meta content='ruby on rails, rails, ruby, ruby on rails training, ruby application development, ruby on rails application development, ember application development, ember.js application development, software application development, web, web application development, mobile, mobile application development, ios, ios application development, iphone, iphone application development, android, android application development, postgres, startups, enterprise, Boston, MA, Massachusetts, for hire' name='keywords'><meta content='web development, mobile development, startups, enterprise, ruby on rails, rails, ruby, ruby on rails training, Boston, for hire' name='keywords'><meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0' name='viewport'><meta content='DockYard.com - Exploring design patterns and their use cases' name='description'><meta content='dougyun' name='twitter:creator'><meta content='summary' name='twitter:card'><meta content='@DockYard' name='twitter:site'><meta content='http://reefpoints.dockyard.com/2013/11/05/design-patterns-command-pattern.html' name='twitter:url'><meta content='Design Patterns: The Command Pattern' name='twitter:title'><meta content='Exploring design patterns and their use cases' name='twitter:description'><link href='http://dockyard.com/humans.txt' rel='author'><link href='/apple-touch-icon.png' rel='apple-touch-icon'><link href='/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'><script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24185112-2']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
<!--
                                                                    ..
                                                                 ,Z+O.
                                                              .OO.O..
                                                             OZ..O.
                                                         ..OO..87.
                                                        .O7O..O...
                                                      .O...Z~O.
                                                   .:Z~. ..Z..
                                                  +O.O   .8..
                                     ...       .OO.  O  O?.
                             ..ZOOOOOOOOOZOOO.ZOZ.   .OO..
                           .OOOOOOOOOOOOOOOOOO..Z.   $O.
                         .ZOOOOOOOOOOOOOOOOOO.  .O..O.
                        .ZOOOOOOOOOOOOOOOOOOOZ  .:O$.
                        OZOOOOOOOOOOO...OOOOOOOZ$ZO
                      ..OOOOOOOOOOOOO  .OOOOOOOOOOO..
                      .OOOOOOOOOOOOOOOOOOOOOOOOOOOOO.
                      .OOOOOOOOOOOOOOOOOOOOOOOOOOOOZ.
                      OOOOOOOOOOOOOOOOOOOOOOOOOOOOOO.
                     .OOOOOOOOOOOOOOOOOOOOOOOOOOOOOO.
                     :OOOOOOOOOOOOOOOOOOOOOOOOOOOOOO.
                     ZOOOOOOOOOOOOOOOOOOOOOOOOOOOOOZ.
                     OOOOOOOOOOOOOOOOOOOOOOOOOOOO7OO.
                     ZOOOOOOOOOOOOOOOOOOOOOOOOOOOOOZ.
                     OOOOOOZOOOOOOOO.ZOOOOOOOOOOO7OO.
                     ZOOOOO.OOOOOOOO.OOOOOOOOOO.  OO.
...     ..           OOOOO.OOOOOOOO.OOOOOOOOO.   .O:
.OOZ...OOO.        ..OOOOO.OOOOOOO.OOOOOOOOZ.    .Z..
.OOOOOOOOO         .ZOOOOO.OOOOO..OOOOOOOO~      .Z
 .OOOOOOO.         .OOOOOO.OZZ..OOOOOOOOO.      .?O
  .OOOOOI.        .OOOOOOO..,ZOOOOOOOOOO..      .O.
   .OOOOZ.      ..ZOOOOOOOOOOOOOOOOOOOO~        .O.
   .OOOOO= .....ZOOOOOOOOOOOOOOOOOOOOOO.      ..O.
   ..OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOZ       .,OO.
    .ZOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO.     ...OO..
     .OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO.   ...OO.
     ..ZOOOOOOOOOOOOOOOOOOOOOOOOOOOO.... OZO..
      ...OOOOOOOOOOOOOOOOOOOOOOOOOOZOOOZO...
          .....~OOOOOOOOOOOOOOOOO:........
                ................
--></head><body id='blog'><header id='mobile-header'><div class='wrap'><a class='header-logo' href='/'>DockYard</a><div class='menu-button'></div></div><ul class='flexnav' data-breakpoint='481' id='mobile-nav'><li class='mobile-nav-link-wrap'><a class='mobile-nav-link' href='http://dockyard.com'><span class='mobile-nav-icon fontello'>h</span><p class='main-nav-item'>Home</p></a></li><li class='mobile-nav-link-wrap'><a class='mobile-nav-link' href='http://dockyard.com'><span class='mobile-nav-icon fontello'>w</span><p class='main-nav-item'>Work</p></a></li><li class='mobile-nav-link-wrap'><a class='mobile-nav-link' href='http://dockyard.com'><span class='mobile-nav-icon fontello'>p</span><p class='main-nav-item'>Team</p></a></li><li class='mobile-nav-link-wrap'><a class='mobile-nav-link' href='http://dockyard.com'><span class='mobile-nav-icon fontello'>c</span><p class='main-nav-item'>Community</p></a></li><li class='mobile-nav-link-wrap'><a class='mobile-nav-link' href='/'><span class='mobile-nav-icon fontello'>b</span><p class='main-nav-item'>Blog</p></a></li><li class='mobile-nav-link-wrap'><a class='mobile-nav-link' href='http://dockyard.com/hire-us'><span class='mobile-nav-icon fontello'>m</span><p class='main-nav-item'>Contact</p></a></li></ul></header><header id='site-header'><div class='wrap'><h1><a class='header-logo' href='http://dockyard.com'>DockYard</a></h1><ul class='main-nav'><li class='nav-work'><a class='main-nav-item' href='http://dockyard.com/work'>Work</a></li><li class='nav-work'><a class='main-nav-item' href='http://dockyard.com/team'>Team</a></li><li class='nav-work'><a class='main-nav-item' href='http://dockyard.com/community'>Community</a></li><li class='nav-work'><a class='main-nav-item current' href='/'>Blog</a></li><li class='nav-work'><a class='main-nav-item' href='http://dockyard.com/contact'>Contact</a></li></ul></div></header><section id='content'><section id='post'><aside class='post-metas-wrap'><ul class='post-metas'><li class='post-meta'><a class="post-author" href="/authors/doug-yun.html">Doug Yun</a></li><li class='post-meta'><span><a class='link link-in-post fontello' href='http://twitter.com/dougyun' target='_blank'>t</a><a class='link link-in-post fontello' href='https://github.com/duggiefresh' target='_blank'>g</a></span></li><li class='post-meta post-date'>05 Nov 2013</li></ul></aside><div class='post-div'><p class='post-meta post-tags'><a class="tag-link" href="/categories/software-design-patterns.html">Software Design Patterns (6)</a>, <a class="tag-link" href="/categories/ruby.html">Ruby (33)</a><a class="tag-link" style="float: right" href="/categories.html">See all categories</a></p><div class='post-title-wrap'><h1 class='post-title'>Design Patterns: The Command Pattern</h1></div><current_page class='post-content'><h2>Let&#39;s get ready for some football!</h2>

<p>One of my favorite sports is American football; it&#39;s strategic, physical,
and wild! As a fan - and once high school player - of the sport, I&#39;ve gained some
valuable lessons from my experiences. For example, I&#39;ve learned that &quot;persistence
is key&quot;, &quot;giving up is for losers&quot;, and that &quot;water sucks, Gatorade is better.&quot;</p>

<p>While those are fine gems of wisdom, today we&#39;ll be
covering one of the most overlooked teachings in football: the power
of <strong>Command</strong> pattern.</p>

<p>The <strong>Command</strong> design pattern intends to separate and decouple an object of invocation
from the object that receives the message of invocation. We will
encapsulate all pertinent information of a method and execute the method
at a later time. Essentially, the <strong>Command</strong> pattern gives us the ability
to queue a series of operations for a later time. Let&#39;s dig in.</p>

<h2>Put me in, Coach!</h2>

<p>Let&#39;s start by creating a <code>BostonNarwin</code> class from which our
football players will inherit from.</p>
<div class="highlight ruby "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
</pre></td>
  <td class="code"><pre><span class="comment"># football.rb</span>

<span class="keyword">class</span> <span class="class">BostonNarwin</span>
  attr_reader <span class="symbol">:action</span>

  <span class="keyword">def</span> <span class="function">initialize</span>(action)
    <span class="instance-variable">@action</span> = action
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">name</span>
    <span class="predefined-constant">self</span>.class
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div></div>
<p>Next, we&#39;ll need some key players; let&#39;s create <code>Quarterback</code> and <code>Receiver</code> classes.
For fun, we&#39;re going to add a <code>TeamOwner</code> class too.
All three of these classes are going to possess a method called <code>#execute</code>.</p>

<p>Each of these classes can be considered as instances of separate
<strong>commands</strong>.</p>
<div class="highlight ruby "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
31
32
33
34
35
36
37
38
39
<strong>40</strong>
41
42
43
44
45
46
47
48
49
<strong>50</strong>
51
52
53
54
</pre></td>
  <td class="code"><pre><span class="comment"># football.rb</span>

<span class="keyword">class</span> <span class="class">Quarterback</span> &lt; <span class="constant">BostonNarwin</span>
  attr_reader <span class="symbol">:path</span>, <span class="symbol">:play</span>

  <span class="keyword">def</span> <span class="function">initialize</span>(path, play)
    <span class="keyword">super</span> <span class="string"><span class="delimiter">'</span><span class="content">Hut! Hut! Red 19! Red 19! Hike!</span><span class="delimiter">'</span></span>
    <span class="instance-variable">@path</span> = path
    <span class="instance-variable">@play</span> = play
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">execute</span>
    file = <span class="constant">File</span>.open path, <span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>
    file.write <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>name<span class="inline-delimiter">}</span></span><span class="content">: </span><span class="inline"><span class="inline-delimiter">#{</span>play<span class="inline-delimiter">}</span></span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
    file.close
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">class</span> <span class="class">Receiver</span> &lt; <span class="constant">BostonNarwin</span>
  attr_reader <span class="symbol">:path</span>, <span class="symbol">:play</span>

  <span class="keyword">def</span> <span class="function">initialize</span>(path, play)
    <span class="keyword">super</span> <span class="string"><span class="delimiter">'</span><span class="content">Run, run, run!!!</span><span class="delimiter">'</span></span>
    <span class="instance-variable">@path</span> = path
    <span class="instance-variable">@play</span> = play
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">execute</span>
    file = <span class="constant">File</span>.open path, <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>
    file.write <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>name<span class="inline-delimiter">}</span></span><span class="content">: </span><span class="inline"><span class="inline-delimiter">#{</span>play<span class="inline-delimiter">}</span></span><span class="char">\n</span><span class="delimiter">&quot;</span></span>
    file.close
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">class</span> <span class="class">TeamOwner</span> &lt; <span class="constant">BostonNarwin</span>
  attr_reader <span class="symbol">:path</span>, <span class="symbol">:target</span>

  <span class="keyword">def</span> <span class="function">initialize</span>(path, target)
    <span class="keyword">super</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">We are moving the team from </span><span class="inline"><span class="inline-delimiter">#{</span>prettify path<span class="inline-delimiter">}</span></span><span class="content"> to </span><span class="inline"><span class="inline-delimiter">#{</span>prettify target<span class="inline-delimiter">}</span></span><span class="content">!</span><span class="delimiter">&quot;</span></span>
    <span class="instance-variable">@path</span> = path
    <span class="instance-variable">@target</span> = target
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">execute</span>
    <span class="constant">FileUtils</span>.mv path, target
    file = <span class="constant">File</span>.open target, <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>
    file.write <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>name<span class="inline-delimiter">}</span></span><span class="content">: We moved from </span><span class="inline"><span class="inline-delimiter">#{</span>prettify path<span class="inline-delimiter">}</span></span><span class="content"> to </span><span class="inline"><span class="inline-delimiter">#{</span>prettify target<span class="inline-delimiter">}</span></span><span class="content">!</span><span class="delimiter">&quot;</span></span>
    file.close
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">prettify</span>(pathname)
    (pathname.chomp <span class="constant">File</span>.extname(pathname)).capitalize
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div></div>
<p>Next, let&#39;s create a class that keeps track of the <code>Quarterback</code>, <code>Receiver</code>, and
<code>TeamOwner</code> commands. We can use the
<a href="http://reefpoints.dockyard.com/2013/10/01/design-patterns-composite-pattern.html"><strong>Composite</strong> pattern</a>
to create this new class.</p>
<div class="highlight ruby "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
</pre></td>
  <td class="code"><pre><span class="comment"># football.rb</span>

<span class="keyword">class</span> <span class="class">CompositeCommand</span> &lt; <span class="constant">BostonNarwin</span>
  attr_accessor <span class="symbol">:commands</span>

  <span class="keyword">def</span> <span class="function">initialize</span>
    <span class="instance-variable">@commands</span> = []
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">add_command</span>(*args)
    args.each { |arg| commands &lt;&lt; arg }
  <span class="keyword">end</span>

  <span class="keyword">def</span> <span class="function">execute</span>
    commands.each { |command| command.execute }
  <span class="keyword">end</span>
<span class="keyword">end</span>
</pre></td>
</tr></table>
</div></div>
<p>Now, we can kickoff some football commands!</p>
<div class="highlight  "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>load 'football.rb'

quarterback = Quarterback.new('boston.txt', 'I'm going to throw a perfect pass!')
# =&gt; #&lt;Quarterback:0x007ff6f5c5c148
     @action=&quot;Hut! Hut! Red 19! Red 19! Hike!&quot;,
     @path=&quot;boston.txt&quot;,
     @play=&quot;I'm going to throw a perfect pass!&quot;&gt;

receiver = Receiver.new('boston.txt', 'I'm going to catch the ball!')
# =&gt; #&lt;Receiver:0x007ff6f5c949f8
     @action=&quot;Run, run, run!!!&quot;,
     @path=&quot;boston.txt&quot;,
     @play=&quot;I'm going to catch the ball!&quot;&gt;

team_owner = TeamOwner.new('boston.txt', 'somerville.txt')
# =&gt; #&lt;TeamOwner:0x007ff6f5ccd028
     @action=&quot;We are moving the team from Boston to Somerville!&quot;,
     @path=&quot;boston.txt&quot;,
     @target=&quot;somerville.txt&quot;&gt;
</pre></td>
</tr></table>
</div></div>
<p>Great! Now we&#39;ll create an instance of the <code>CompositeCommand</code>, add
each sub-command with <code>#add_command</code>, and then execute each command
with <code>#execute</code>.</p>
<div class="highlight  "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
</pre></td>
  <td class="code"><pre>command = CompositeCommand.new
# =&gt; #&lt;CompositeCommand:0x007ff6f5b82948 @commands=[]&gt;

command.add_command quarterback, receiver, team_owner
# =&gt; [#&lt;Quarterback:0x007ff6f5c5c148
     @action=&quot;Hut! Hut! Red 19! Red 19! Hike!&quot;,
     @path=&quot;boston.txt&quot;,
     @play=&quot;I'm going to throw a perfect pass!&quot;&gt;,
     #&lt;Receiver:0x007ff6f5c949f8
     @action=&quot;Run, run, run!!!&quot;,
     @path=&quot;boston.txt&quot;,
     @play=&quot;I'm going to catch the ball!&quot;&gt;,
     #&lt;TeamOwner:0x007ff6f5ccd028
     @action=&quot;We are moving the team from Boston to Somerville!&quot;,
     @path=&quot;boston.txt&quot;,
     @target=&quot;somerville.txt&quot;&gt;]

command.execute
# ...  Omitted for brevity ...

exit
</pre></td>
</tr></table>
</div></div>
<p>Finally, let&#39;s list out the files in our current directory and view the contents
of our recently created text file.</p>
<div class="highlight  "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre>$ ls
# =&gt; football.rb   somerville.txt

$ less somerville.txt
# =&gt; Quarterback: I'm going to throw a perfect pass!
     Receiver: I'm going to catch the ball!
     TeamOwner: We moved from Boston to Somerville!
</pre></td>
</tr></table>
</div></div>
<p>Wow! The <strong>Command</strong> pattern in action!</p>

<h2>Discussion</h2>

<p>The <strong>Command</strong> pattern suggests that we create objects that perform
specific tasks and actions. For our example, the <code>Quarterback</code> object
created a file, the <code>Receiver</code> appended to the file, and the <code>TeamOwner</code>
object moved it. Each of the command objects completed their action
through <code>CompositeCommand#execute</code>.</p>

<p>Having one object, an instance of <code>CompositeCommand</code>, that executes all
stored commands presents us with solutions ranging from simple file
manipulation to user triggered interaction. The <strong>Command</strong> pattern
also allows us to &quot;store&quot; and &quot;remember&quot; commands prior to and after
execution.</p>

<p>Hope you enjoyed our example and go Boston Narwins!</p>
</current_page><p class='issue'>See a problem with the current page? &nbsp;<a href='https://github.com/dockyard/reefpoints/blob/master/source/posts/' target='_blank'>Send a pull request to contribute, we'll happily accept!</a></p><section class='post-share'><h1>Like the current page? Please share!</h1><div class='social-button'><a class='twitter-share-button' data-url='http://reefpoints.dockyard.com/2013/11/05/design-patterns-command-pattern.html' data-via='DockYard' href='https://twitter.com/share'>Tweet</a></div><script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');
</script><div class='social-button'><div class='g-plusone' data-href='#' data-size='medium' data-width='100'></div><script>
  (function() {var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;po.src = 'https://apis.google.com/js/plusone.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
</script></div></section><section id='post-comments'><div id='disqus_thread'></div><script>
  var disqus_shortname = 'reefpoints';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script><noscript>Please enable JavaScript to view the <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a></noscript></noscript></section></div></section><script>
  var path = window.location.pathname.split('/').reverse();
  var postname = path[0].split('.');
  var change = postname[0] + '.md';
  var newpath = 'https://github.com/dockyard/reefpoints/blob/master/source/posts/' + path[3] + '-' + path[2] + '-' + path[1] + '-' + change
  $('.issue a').attr('href', newpath);
</script>
</section><footer><ul class='footer-links'><li><a class='link link-in-footer fontello' href='https://github.com/DockYard' target='_blank'>g</a></li><li><a class='link link-in-footer fontello' href='https://twitter.com/DockYard' target='_blank'>t</a></li><li><a class='link link-in-footer fontello' href='http://reefpoints.dockyard.com/atom.xml' target='_blank'>r</a></li><li><a class='link link-in-footer fontello' href='http://dockyard.com/hire-us' target='_blank'>m</a></li></ul><form class='footer-form'><label class='footer-form-label'>Get in touch with us!</label><input class='footer-form-input' placeholder='Email' type='text'><button class='footer-form-submit fontello' href='http://dockyard.com/contact'>R</button></form><a class='footer-number' href='tel:855-362-5973'>(855) DOCK-YRD</a><p class='footer-copyright'>&copy; 2013 DockYard, LLC. All Rights Reserved.</p></footer><audio class='foghorn' preload='auto' src='/sound/foghorn.mp3'></audio><script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'reefpoints'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script></body></html>
